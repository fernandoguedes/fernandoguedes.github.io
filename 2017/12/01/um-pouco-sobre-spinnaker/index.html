<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Um pouco sobre o Spinnaker - Abstraindo as complexidades da entrega cont√≠nua &middot; Lu√≠s Fernando Guedes</title>
        <meta name="description" content="Ol√°, v√£o fazer tr√™s meses que entrei na Portal Telemedicina, e uma das minhas miss√µes iniciais era tornar √°gil o processo de entrega de software, basicamente fazer funcionar o fluxo de ponta a ponta - do desenvolvimento ao deploy - com o processo todo automatizado, sem a necessidade de trabalhos manuais para a entrega em diferentes ambientes.
Em janeiro desse ano (2017) a Portal participou de uma sele√ß√£o mundial do programa Launchpad Accelerator e teve a oportunidade de contar com o expertise da Google, fez treinamentos, foi acelerada financeiramente e atrav√©s de cr√©ditos em produtos e sevi√ßos, em meio a essa troca de experi√™ncias e conhecimento, o nosso CEO Rafael Figueroa, conheceu o Spinnaker, compartilhou comigo e disse que poderia ser nosso forte aliado na automa√ß√£o de todo esse processo.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.53" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Um pouco sobre o Spinnaker - Abstraindo as complexidades da entrega cont√≠nua">
<meta property="og:description" content="Ol√°, v√£o fazer tr√™s meses que entrei na Portal Telemedicina, e uma das minhas miss√µes iniciais era tornar √°gil o processo de entrega de software, basicamente fazer funcionar o fluxo de ponta a ponta - do desenvolvimento ao deploy - com o processo todo automatizado, sem a necessidade de trabalhos manuais para a entrega em diferentes ambientes.
Em janeiro desse ano (2017) a Portal participou de uma sele√ß√£o mundial do programa Launchpad Accelerator e teve a oportunidade de contar com o expertise da Google, fez treinamentos, foi acelerada financeiramente e atrav√©s de cr√©ditos em produtos e sevi√ßos, em meio a essa troca de experi√™ncias e conhecimento, o nosso CEO Rafael Figueroa, conheceu o Spinnaker, compartilhou comigo e disse que poderia ser nosso forte aliado na automa√ß√£o de todo esse processo.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://fguedes.me/2017/12/01/um-pouco-sobre-spinnaker/">
        <link rel="stylesheet" href="https://fguedes.me/dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="~fguedes üï±" href="https://fguedes.me/">~fguedes üï±</a>
                            </h1>
                        
                        <a class="button-square" href="https://fguedes.me/index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Gitlab" title="Gitlab" href="https://gitlab.com/fguedes">
                                <i class="fa fa-gitlab"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/fernandoguedes">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Stack Overflow" title="Stack Overflow" href="https://pt.stackoverflow.com/users/11940/lu%c3%ads-fernando-guedes">
                                <i class="fa fa-stack-overflow"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://linkedin.com/in/lfernandoguedes/">
                                <i class="fa fa-linkedin"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:lfernandoguedes@gmail.com">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Um pouco sobre o Spinnaker - Abstraindo as complexidades da entrega cont√≠nua</h1>
    
    <p class="post-date">
        <span>Published <time datetime="2017-12-01" itemprop="datePublished">Dec 1, 2017</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="https://plus.google.com/u/0/&#43;Lu%c3%adsFernandoGuedes" itemprop="url" rel="author">Lu√≠s Fernando Guedes</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    

<p>Ol√°, v√£o fazer tr√™s meses que entrei na <a href="http://portaltelemedicina.com.br/">Portal Telemedicina</a>, e uma das minhas miss√µes iniciais era tornar √°gil o processo de entrega de software, basicamente fazer funcionar o fluxo de ponta a ponta - do desenvolvimento ao deploy - com o processo todo automatizado, sem a necessidade de trabalhos manuais para a entrega em diferentes ambientes.</p>

<p>Em janeiro desse ano (2017) a Portal participou de uma sele√ß√£o mundial do programa <a href="http://portaltelemedicina.com.br/portal-telemedicina-acelerada-google/">Launchpad Accelerator</a> e teve a oportunidade de contar com o expertise da Google, fez treinamentos, foi acelerada financeiramente e atrav√©s de cr√©ditos em produtos e sevi√ßos, em meio a essa troca de experi√™ncias e conhecimento, o nosso CEO Rafael Figueroa, conheceu o <a href="https://spinnaker.io">Spinnaker</a>, compartilhou comigo e disse que poderia ser nosso forte aliado na automa√ß√£o de todo esse processo.</p>

<h2 id="hist√≥ria">Hist√≥ria</h2>

<p>O Spinnaker foi criado para satisfazer as necessidades internas de deploy e gerenciamento de infraestrutura da Netflix, e desde 2014 vinha sendo utilizado, efetuando mais de 3000 deploys/dia em 1000 microsservi√ßos (!). Com a ferramenta em pleno funcionamento, em parceria com o Google a tornaram open-source em outubro de 2015, e desde ent√£o, vem ganhando o mundo.</p>

<h2 id="composi√ß√£o">Composi√ß√£o</h2>

<blockquote>
<p>Spinnaker is an open source, multi-cloud continuous delivery platform that helps you release software changes with high velocity and confidence.</p>
</blockquote>

<p>A ferramenta √© um conjunto de microsservi√ßos e drivers que se integram a diferentes <em>cloud providers</em> e oferece diferentes estrat√©gias de deploy - do red/black (blue/green) ao canary - abstraindo a complexidade do controle e gerenciamento da infraestrutura necess√°ria para que esse processo seja √°gil e funcione da maneira correta.</p>

<h3 id="microsservi√ßos">Microsservi√ßos</h3>

<p>O Spinnaker √© composto por 10 microsservi√ßos entre APIs, frontends, integra√ß√µes e persist√™ncia de dados, abaixo cada uma e responsabilidades:</p>

<p><img src="/spinnaker/architeture.png" alt="Arquitetura do Spinnaker" /></p>

<ul>
<li><a href="https://github.com/spinnaker/deck">Deck</a>: Interface web para gerenciamento e acompanhamento de todas as execu√ß√µes background da ferramenta;</li>
<li><a href="https://github.com/spinnaker/gate">Gate</a>: Gateway de APIs, respons√°vel pela distribui√ß√£o de requests aos microsservi√ßos;</li>
<li><a href="https://github.com/spinnaker/orca">Orca</a>: Controla todas as opera√ß√µes e pipelines;</li>
<li><a href="https://github.com/spinnaker/clouddriver">Clouddriver</a>: Orquestra√ß√£o de clusters e containers multi <em>cloud provider</em>;</li>
<li><a href="https://github.com/spinnaker/front50">Front50</a>: Persist√™ncia de dados utilizando Redis, garante hist√≥rico de opera√ß√µes, builds, pipelines, deploys, etc;</li>
<li><a href="https://github.com/spinnaker/rosco">Rosco</a>: Respons√°vel por buildar imagens vindas de diferentes servi√ßos (como <a href="https://cloud.google.com/compute/docs/images">GCE Images</a>, <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html">AWS AMIs</a>);</li>
<li><a href="https://github.com/spinnaker/rosco">Igor</a>: Fornece interface para triggers que podem ser integrados aos pipelines, possui integra√ß√£o com webhooks e algumas ferramentas como Jenkins e Travis;</li>
<li><a href="https://github.com/spinnaker/rosco">Echo</a>: Sistema de notifica√ß√£o;</li>
<li><a href="https://github.com/spinnaker/rosco">Fiat</a>: Faz o controle de acesso em um sistema baseado em RBAC - Role Based Access Control;</li>
<li><a href="https://github.com/spinnaker/halyard">Halyard</a>: Servi√ßo que faz a configura√ß√£o e gerenciamento do Spinnaker e seus microsservi√ßos, permite instalar, atualizar e fazer rollbacks.</li>
</ul>

<p>Uma vantagem dessa arquitetura, √© que conseguimos acessar pequenas partes do todo, com isso, facilitando integra√ß√µes externas a processos que n√£o sigam o convencional, exemplo: executar um pipeline de deploy via comando de um bot do slack.</p>

<h3 id="pipelines">Pipelines</h3>

<p>O pipeline pode ser um processo, um conjunto de processos ou um conjunto de pipelines, para ilustrar melhor visualize a imagem abaixo:</p>

<p><img src="/spinnaker/pipelines.jpeg" alt="Pipelines" /></p>

<p>Para ativar um pipeline √© necess√°rio um trigger que pode ser um webhook ou um registry (<a href="https://docs.docker.com/registry/">the Registry is a stateless, highly scalable server side application that stores and lets you distribute Docker images</a>).</p>

<ul>
<li>Bake &amp; Deploy to Test: Consiste em preparar o que for necess√°rio para enviar seu <em>app</em> para o ambiente de teste;</li>
<li>Validate Test: Pelo fato do Spinnaker tamb√©m oferecer triggers que podem ser ativados manualmente, ao enviar algo para o ambiente de QA por exemplo, voc√™ pode determinar que apenas os testadores podem validar e manualmente  aprovar (podendo ser tamb√©m acessado via API) o seu envio para um ambiente de homologa√ß√£o;</li>
<li>Promote to Prod: Automatizado, sem estresse, faz o deploy utilizando clusters, inst√¢ncias, kubernetes e load balancers, de acordo com a estrat√©gia configurada, como disse anteriormente possui diferentes estrat√©gias que s√£o gerenciadas pela pr√≥pria ferramenta.</li>
</ul>

<h2 id="portal-telemedicina">Portal Telemedicina</h2>

<p>Tivemos alguns desafios iniciais aqui na Portal, primeiramente precis√°vamos criar toda a estrutura b√°sica de testes, checagem est√°tica de c√≥digo e formata√ß√£o, depois adicionar isso aos pipelines do <a href="https://bitbucket.org">Bitbucket</a> (plataforma que atualmente usamos aqui), &ldquo;dockerizar&rdquo; as aplica√ß√µes, criar a infraestrutura do Spinnaker e seus microsservi√ßos, e por fim, o principal, integrar e juntar as pontas. Acabamos utilizando webhooks (git) entre Bitbucket e Google Cloud Registry, e um &ldquo;observador&rdquo; de imagens entre Google Cloud Registry e Spinnaker, tudo isso sobre a orquestra√ß√£o do git flow - com algumas adapta√ß√µes.</p>

<p>Partimos praticamente do zero para entrega cont√≠nua em pouco mais de um m√™s com import√¢ncia fundamental do Spinnaker, at√© agora os resultados foram satisfat√≥rios, em momentos intensos de entrega, conseguimos realizar diversos deploys por dia sem downtime, diminuindo o tempo entre a entrega e o ciclo de feedback.</p>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/integra%C3%A7%C3%A3o-cont%C3%ADnua/">Integra√ß√£o Cont√≠nua</a>, 
            
                <a href="/tags/deploy-cont%C3%ADnuo/">Deploy Cont√≠nuo</a>, 
            
                <a href="/tags/spinnaker/">spinnaker</a>, 
            
                <a href="/tags/docker/">docker</a>, 
            
                <a href="/tags/kubernetes/">kubernetes</a>
            
        </p>
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Um%20pouco%20sobre%20o%20Spinnaker%20-%20Abstraindo%20as%20complexidades%20da%20entrega%20cont%c3%adnua&url=https%3a%2f%2ffguedes.me%2f2017%2f12%2f01%2fum-pouco-sobre-spinnaker%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ffguedes.me%2f2017%2f12%2f01%2fum-pouco-sobre-spinnaker%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
            <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2ffguedes.me%2f2017%2f12%2f01%2fum-pouco-sobre-spinnaker%2f"
              onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
              <i class="fa fa-google-plus"></i>
                <span class="hidden">Google+</span>
            </a>
        
        
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="~fguedes üï±" href="https://fguedes.me/">~fguedes üï±</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2018 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="https://fguedes.me/js/jquery-1.11.3.min.js"></script>
        <script src="https://fguedes.me/js/jquery.fitvids.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        <script src="https://fguedes.me/js/scripts.js"></script>
    </body>
</html>

